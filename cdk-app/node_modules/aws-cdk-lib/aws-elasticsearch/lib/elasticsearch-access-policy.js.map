{
  "version": 3,
  "sources": ["elasticsearch-access-policy.ts"],
  "sourcesContent": ["import * as iam from '../../aws-iam';\nimport * as cr from '../../custom-resources';\nimport { Construct } from 'constructs';\n\n/**\n * Construction properties for ElasticsearchAccessPolicy\n */\nexport interface ElasticsearchAccessPolicyProps {\n  /**\n   * The Elasticsearch Domain name\n   */\n  readonly domainName: string;\n\n  /**\n   * The Elasticsearch Domain ARN\n   */\n  readonly domainArn: string;\n\n  /**\n   * The access policy statements for the Elasticsearch cluster\n   */\n  readonly accessPolicies: iam.PolicyStatement[];\n}\n\n/**\n * Creates LogGroup resource policies.\n */\nexport class ElasticsearchAccessPolicy extends cr.AwsCustomResource {\n  constructor(scope: Construct, id: string, props: ElasticsearchAccessPolicyProps) {\n    const policyDocument = new iam.PolicyDocument({\n      statements: props.accessPolicies,\n    });\n\n    super(scope, id, {\n      resourceType: 'Custom::ElasticsearchAccessPolicy',\n      onUpdate: {\n        action: 'updateElasticsearchDomainConfig',\n        service: 'ES',\n        parameters: {\n          DomainName: props.domainName,\n          AccessPolicies: JSON.stringify(policyDocument.toJSON()),\n        },\n        // this is needed to limit the response body, otherwise it exceeds the CFN 4k limit\n        outputPaths: ['DomainConfig.ElasticsearchClusterConfig.AccessPolicies'],\n        physicalResourceId: cr.PhysicalResourceId.of(`${props.domainName}AccessPolicy`),\n      },\n      policy: cr.AwsCustomResourcePolicy.fromSdkCalls({ resources: [props.domainArn] }),\n    });\n  }\n}\n"],
  "mappings": "6GAAA,KAAA,KAAA,QAAA,iBACA,GAAA,QAAA,0BA0BA,uCAA+C,IAAG,iBAAiB,CACjE,YAAY,MAAkB,GAAY,MAAqC,CAC7E,KAAM,gBAAiB,GAAI,KAAI,eAAe,CAC5C,WAAY,MAAM,iBAGpB,MAAM,MAAO,GAAI,CACf,aAAc,oCACd,SAAU,CACR,OAAQ,kCACR,QAAS,KACT,WAAY,CACV,WAAY,MAAM,WAClB,eAAgB,KAAK,UAAU,eAAe,WAGhD,YAAa,CAAC,0DACd,mBAAoB,GAAG,mBAAmB,GAAG,GAAG,MAAM,2BAExD,OAAQ,GAAG,wBAAwB,aAAa,CAAE,UAAW,CAAC,MAAM,gBAnB1E,QAAA,0BAAA",
  "names": []
}
