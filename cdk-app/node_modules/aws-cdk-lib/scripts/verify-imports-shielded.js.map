{
  "version": 3,
  "sources": ["verify-imports-shielded.ts"],
  "sourcesContent": ["/**\n * Check that the imports from 'aws-cdk-lib' we expect to work, work, and those we have shielded off don't work.\n */\nimport * as os from 'os';\nimport * as path from 'path';\nimport * as fs from 'fs-extra';\n\nasync function main() {\n  // First make a tempdir and symlink `aws-cdk-lib` into it so we can refer to it\n  // as if it was an installed module.\n  await withTemporaryDirectory(async (tmpDir) => {\n    await fs.mkdirp(path.join(tmpDir, 'node_modules'));\n    await fs.symlink(path.resolve(__dirname, '..'), path.join(tmpDir, 'node_modules', 'aws-cdk-lib'));\n\n    assertImportSucceeds('aws-cdk-lib');\n    assertImportFails('aws-cdk-lib/LICENSE', 'ERR_PACKAGE_PATH_NOT_EXPORTED');\n    assertImportFails('aws-cdk-lib/aws-s3/lib/bucket', 'ERR_PACKAGE_PATH_NOT_EXPORTED');\n    assertImportSucceeds('aws-cdk-lib/aws-s3');\n\n    function assertImportSucceeds(name: string) {\n      require.resolve(name, { paths: [tmpDir] });\n    }\n\n    function assertImportFails(name: string, code: string) {\n      try {\n        require.resolve(name, { paths: [tmpDir] });\n\n        // eslint-disable-next-line no-console\n        console.error(`Import of '${name}' should have produced an error, but didn't.`);\n        process.exitCode = 1;\n      } catch (e) {\n        if ((e as any).code !== code) {\n          // eslint-disable-next-line no-console\n          console.error(`Import of '${name}' should have produced error ${code}, but got ${(e as any).code}.`);\n          process.exitCode = 1;\n        }\n      }\n    }\n  });\n}\n\n\nexport async function withTemporaryDirectory<T>(callback: (dir: string) => Promise<T>): Promise<T> {\n  const tmpdir = await fs.mkdtemp(path.join(os.tmpdir(), path.basename(__filename)));\n  try {\n    return await callback(tmpdir);\n  } finally {\n    await fs.remove(tmpdir);\n  }\n}\n\n\nmain().catch((e) => {\n  // eslint-disable-next-line no-console\n  console.error(e);\n  process.exitCode = 1;\n});\n"],
  "mappings": "0GAGA,KAAA,IAAA,QAAA,MACA,KAAA,QAAA,QACA,GAAA,QAAA,YAEA,qBAAmB,CAGjB,KAAM,wBAAuB,KAAO,SAAU,CAC5C,KAAM,IAAG,OAAO,KAAK,KAAK,OAAQ,iBAClC,KAAM,IAAG,QAAQ,KAAK,QAAQ,UAAW,MAAO,KAAK,KAAK,OAAQ,eAAgB,gBAElF,qBAAqB,eACrB,kBAAkB,sBAAuB,iCACzC,kBAAkB,gCAAiC,iCACnD,qBAAqB,sBAErB,8BAA8B,KAAY,CACxC,QAAQ,QAAQ,KAAM,CAAE,MAAO,CAAC,UAGlC,2BAA2B,KAAc,KAAY,CACnD,GAAI,CACF,QAAQ,QAAQ,KAAM,CAAE,MAAO,CAAC,UAGhC,QAAQ,MAAM,cAAc,oDAC5B,QAAQ,SAAW,QACZ,EAAP,CACA,AAAK,EAAU,OAAS,MAEtB,SAAQ,MAAM,cAAc,oCAAoC,iBAAkB,EAAU,SAC5F,QAAQ,SAAW,OAQtB,sCAAyC,SAAqC,CACnF,KAAM,QAAS,KAAM,IAAG,QAAQ,KAAK,KAAK,GAAG,SAAU,KAAK,SAAS,cACrE,GAAI,CACF,MAAO,MAAM,UAAS,gBAEtB,KAAM,IAAG,OAAO,SALpB,QAAA,uBAAA,uBAUA,OAAO,MAAM,AAAC,GAAK,CAEjB,QAAQ,MAAM,GACd,QAAQ,SAAW",
  "names": []
}
