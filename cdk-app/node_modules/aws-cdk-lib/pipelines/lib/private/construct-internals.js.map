{
  "version": 3,
  "sources": ["construct-internals.ts"],
  "sourcesContent": ["/**\n * Get access to construct internals that we need but got removed from the Stages PR.\n */\nimport * as path from 'path';\nimport { App, Stage } from '../../../core';\nimport * as cxapi from '../../../cx-api';\nimport { Construct, IConstruct, Node } from 'constructs';\n\nexport function appOf(construct: IConstruct): App {\n  const root = Node.of(construct).root;\n\n  if (!App.isApp(root)) {\n    throw new Error(`Construct must be created under an App, but is not: ${Node.of(construct).path}`);\n  }\n\n  return root;\n}\n\nexport function assemblyBuilderOf(stage: Stage): cxapi.CloudAssemblyBuilder {\n  return (stage as any)._assemblyBuilder;\n}\n\nexport function pipelineSynth(stage: Stage) {\n  return stage.synth({ validateOnSynthesis: true });\n}\n\n/**\n * Return the relative path from the app assembly to the scope's (nested) assembly\n */\nexport function embeddedAsmPath(scope: IConstruct) {\n  const appAsmRoot = assemblyBuilderOf(appOf(scope)).outdir;\n  const stage = Stage.of(scope) ?? appOf(scope);\n  const stageAsmRoot = assemblyBuilderOf(stage).outdir;\n  return path.relative(appAsmRoot, stageAsmRoot) || '.';\n}\n\n/**\n * Determine the directory where the cloud assembly will be written, for use in a BuildSpec\n */\nexport function cloudAssemblyBuildSpecDir(scope: IConstruct) {\n  return assemblyBuilderOf(appOf(scope)).outdir;\n}\n\nexport function obtainScope(parent: Construct, id: string): Construct {\n  const existing = Node.of(parent).tryFindChild(id);\n  if (existing) {\n    return existing as Construct;\n  }\n  return new Construct(parent, id);\n}"],
  "mappings": "uNAGA,KAAA,MAAA,QAAA,QACA,OAAA,QAAA,iBAEA,aAAA,QAAA,cAEA,eAAsB,UAAqB,CACzC,KAAM,MAAO,aAAA,KAAK,GAAG,WAAW,KAEhC,GAAI,CAAC,OAAA,IAAI,MAAM,MACb,KAAM,IAAI,OAAM,uDAAuD,aAAA,KAAK,GAAG,WAAW,QAG5F,MAAO,MAPT,QAAA,MAAA,MAUA,2BAAkC,MAAY,CAC5C,MAAQ,OAAc,iBADxB,QAAA,kBAAA,kBAIA,uBAA8B,MAAY,CACxC,MAAO,OAAM,MAAM,CAAE,oBAAqB,KAD5C,QAAA,cAAA,cAOA,yBAAgC,MAAiB,QAC/C,KAAM,YAAa,kBAAkB,MAAM,QAAQ,OAC7C,MAAK,IAAG,OAAA,MAAM,GAAG,UAAM,MAAA,KAAA,OAAA,GAAI,MAAM,OACjC,aAAe,kBAAkB,OAAO,OAC9C,MAAO,MAAK,SAAS,WAAY,eAAiB,IAJpD,QAAA,gBAAA,gBAUA,mCAA0C,MAAiB,CACzD,MAAO,mBAAkB,MAAM,QAAQ,OADzC,QAAA,0BAAA,0BAIA,qBAA4B,OAAmB,GAAU,CACvD,KAAM,UAAW,aAAA,KAAK,GAAG,QAAQ,aAAa,IAC9C,MAAI,WAGG,GAAI,cAAA,UAAU,OAAQ,IAL/B,QAAA,YAAA",
  "names": []
}
