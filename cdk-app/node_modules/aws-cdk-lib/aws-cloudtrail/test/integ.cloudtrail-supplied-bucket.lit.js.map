{
  "version": 3,
  "sources": ["integ.cloudtrail-supplied-bucket.lit.ts"],
  "sourcesContent": ["import * as iam from '../../aws-iam';\nimport * as lambda from '../../aws-lambda';\nimport * as s3 from '../../aws-s3';\nimport * as cdk from '../../core';\n\nimport * as cloudtrail from '../lib';\n\nconst app = new cdk.App();\nconst stack = new cdk.Stack(app, 'integ-cloudtrail');\n\nconst bucket = new s3.Bucket(stack, 'Bucket', { removalPolicy: cdk.RemovalPolicy.DESTROY });\nconst lambdaFunction = new lambda.Function(stack, 'LambdaFunction', {\n  runtime: lambda.Runtime.NODEJS_10_X,\n  handler: 'hello.handler',\n  code: lambda.Code.fromInline('exports.handler = {}'),\n});\n\n// using exctecy the same code as inside the cloudtrail class to produce the supplied bucket and policy\nconst cloudTrailPrincipal = new iam.ServicePrincipal('cloudtrail.amazonaws.com');\n\nconst Trailbucket = new s3.Bucket(stack, 'S3', { encryption: s3.BucketEncryption.UNENCRYPTED });\n\nTrailbucket.addToResourcePolicy(new iam.PolicyStatement({\n  resources: [Trailbucket.bucketArn],\n  actions: ['s3:GetBucketAcl'],\n  principals: [cloudTrailPrincipal],\n}));\n\nTrailbucket.addToResourcePolicy(new iam.PolicyStatement({\n  resources: [Trailbucket.arnForObjects(`AWSLogs/${cdk.Stack.of(stack).account}/*`)],\n  actions: ['s3:PutObject'],\n  principals: [cloudTrailPrincipal],\n  conditions: {\n    StringEquals: { 's3:x-amz-acl': 'bucket-owner-full-control' },\n  },\n}));\n\nconst trail = new cloudtrail.Trail(stack, 'Trail', { bucket: Trailbucket });\n\ntrail.addLambdaEventSelector([lambdaFunction]);\ntrail.addS3EventSelector([{ bucket }]);\n\napp.synth();\n"],
  "mappings": "oEAAA,KAAA,KAAA,QAAA,iBACA,OAAA,QAAA,oBACA,GAAA,QAAA,gBACA,IAAA,QAAA,cAEA,WAAA,QAAA,UAEM,IAAM,GAAI,KAAI,IACd,MAAQ,GAAI,KAAI,MAAM,IAAK,oBAE3B,OAAS,GAAI,IAAG,OAAO,MAAO,SAAU,CAAE,cAAe,IAAI,cAAc,UAC3E,eAAiB,GAAI,QAAO,SAAS,MAAO,iBAAkB,CAClE,QAAS,OAAO,QAAQ,YACxB,QAAS,gBACT,KAAM,OAAO,KAAK,WAAW,0BAIzB,oBAAsB,GAAI,KAAI,iBAAiB,4BAE/C,YAAc,GAAI,IAAG,OAAO,MAAO,KAAM,CAAE,WAAY,GAAG,iBAAiB,cAEjF,YAAY,oBAAoB,GAAI,KAAI,gBAAgB,CACtD,UAAW,CAAC,YAAY,WACxB,QAAS,CAAC,mBACV,WAAY,CAAC,wBAGf,YAAY,oBAAoB,GAAI,KAAI,gBAAgB,CACtD,UAAW,CAAC,YAAY,cAAc,WAAW,IAAI,MAAM,GAAG,OAAO,cACrE,QAAS,CAAC,gBACV,WAAY,CAAC,qBACb,WAAY,CACV,aAAc,CAAE,eAAgB,iCAIpC,KAAM,OAAQ,GAAI,YAAW,MAAM,MAAO,QAAS,CAAE,OAAQ,cAE7D,MAAM,uBAAuB,CAAC,iBAC9B,MAAM,mBAAmB,CAAC,CAAE,UAE5B,IAAI",
  "names": []
}
